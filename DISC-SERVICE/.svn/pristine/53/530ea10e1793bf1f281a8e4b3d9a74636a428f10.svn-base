using REPO.Controllers;
using REPO.Models;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web.Http;

namespace API.Controllers
{
    public class DiscountController : ApiController
    {

        [Route("v1/prnetfile_select2_search")]
        [HttpGet]
        public ResponseModel prnetfile_select2_search([FromUri] string id, string text, string keywords)
        {
            try
            {
                DiscountRepository DiscountRepository = new DiscountRepository();

                List<ResponseSelect2Model> dis_pre_group_search = DiscountRepository.prnetfile_select2_search(id, text, keywords);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = dis_pre_group_search;
                _ResponseModel.length = dis_pre_group_search.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }

        [Route("v1/gdishead_select2_search")]
        [HttpGet]
        public ResponseModel gdishead_select2_search([FromUri] string id, string text, string keywords, string name)
        {
            try
            {
                DiscountRepository DiscountRepository = new DiscountRepository();

                List<ResponseSelect2Model> gdishead_select2_search = DiscountRepository.gdishead_select2_search(id, text, keywords, name);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = gdishead_select2_search;
                _ResponseModel.length = gdishead_select2_search.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }

        [Route("v1/stmas_select2_search")]
        [HttpGet]
        public ResponseModel stmas_select2_search([FromUri] string id, string text, string keywords)
        {
            try
            {
                DiscountRepository DiscountRepository = new DiscountRepository();

                List<ResponseStmasSelect2Model> stmas_select2_search = DiscountRepository.stmas_select2_search(id, text, keywords);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = stmas_select2_search;
                _ResponseModel.length = stmas_select2_search.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }

        [Route("v1/discgroup_select2_search")]
        [HttpGet]
        public ResponseModel discgroup_select2_search([FromUri] string id, string text, string keywords)
        {
            try
            {
                DiscountRepository DiscountRepository = new DiscountRepository();

                List<ResponseSelect2Model> discgroup_select2_search = DiscountRepository.discgroup_select2_search(id, text, keywords);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = discgroup_select2_search;
                _ResponseModel.length = discgroup_select2_search.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }

        [Route("v1/gcode_a_select2_search")]
        [HttpGet]
        public ResponseModel gcode_a_select2_search([FromUri] string id, string text, string keywords)
        {
            try
            {
                DiscountRepository DiscountRepository = new DiscountRepository();

                List<ResponseSelect2Model> gcode_a_select2_search = DiscountRepository.gcode_a_select2_search(id, text, keywords);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = gcode_a_select2_search;
                _ResponseModel.length = gcode_a_select2_search.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }

        [Route("v1/gcode_c_select2_search")]
        [HttpGet]
        public ResponseModel gcode_c_select2_search([FromUri] string id, string text, string keywords)
        {
            try
            {
                DiscountRepository DiscountRepository = new DiscountRepository();

                List<ResponseSelect2Model> gcode_c_select2_search = DiscountRepository.gcode_c_select2_search(id, text, keywords);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = gcode_c_select2_search;
                _ResponseModel.length = gcode_c_select2_search.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }



        [Route("v1/dis_emmas_List")]
        [HttpGet]
        public ResponseModel Dis_emmas_List([FromUri] string code, string mode)
        {
            try
            {
                DiscountRepository DiscountRepository = new DiscountRepository();

                List<Dis_pre_emmaspModel> Dis_emmas_List = DiscountRepository.Dis_emmas_List(code, mode);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Dis_emmas_List;
                _ResponseModel.length = Dis_emmas_List.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }



        [Route("v1/Dis_prnetfile_list")]
        [HttpGet]
        public ResponseModel Dis_prnetfile_list([FromUri] string mode)
        {
            try
            {
                DiscountRepository DiscountRepository = new DiscountRepository();

                List<Dis_prnetfileModel> Dis_prnetfile_list = DiscountRepository.Dis_prnetfile_list(mode);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Dis_prnetfile_list;
                _ResponseModel.length = Dis_prnetfile_list.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }

        [Route("v1/Dis_prnetfile_action")]
        [HttpPost]
        public ResponseModel Dis_prnetfile_action([FromBody] Dis_prnetfile_action_Model Dis_prnetfileModel)
        {
            try
            {

                ResponseModel _ResponseCheckModel = new ResponseModel();
                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseCheckModel = Dis_prnetfile_check(Dis_prnetfileModel.code);

                if (_ResponseCheckModel.length <= 0 && Dis_prnetfileModel.mode == "CREATE")
                {
                    DiscountRepository DiscountRepository = new DiscountRepository();

                    DiscountRepository.Dis_prnetfile_action(Dis_prnetfileModel);

                    _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                    _ResponseModel.data = Dis_prnetfileModel.mode;
                    //_ResponseModel.length = Dis_prnetfile_action.Count();
                    _ResponseModel.status = "Success";

                }
                else if (_ResponseCheckModel.length > 0 && Dis_prnetfileModel.mode == "CREATE")
                {

                    _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                    _ResponseModel.length = _ResponseCheckModel.length;
                    _ResponseModel.status = "Duplicate";

                }
                else if (_ResponseCheckModel.length > 0 && Dis_prnetfileModel.mode != "CREATE") 
                {

                    DiscountRepository DiscountRepository = new DiscountRepository();

                    DiscountRepository.Dis_prnetfile_action(Dis_prnetfileModel);

                    _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                    _ResponseModel.data = Dis_prnetfileModel.mode;
                    //_ResponseModel.length = Dis_prnetfile_action.Count();
                    _ResponseModel.status = "Success";

                }
                else
                {
                    _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                    _ResponseModel.length = _ResponseCheckModel.length;
                    _ResponseModel.status = "Error";
                }


                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }

        [Route("v1/Dis_prnetfile_check")]
        [HttpGet]
        public ResponseModel Dis_prnetfile_check([FromUri] string code)
        {
            try
            {
                DiscountRepository DiscountRepository = new DiscountRepository();

                List<Dis_prnetfile_check_Model> Dis_prnetfile_check = DiscountRepository.Dis_prnetfile_check(code);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Dis_prnetfile_check;
                _ResponseModel.length = Dis_prnetfile_check.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }



        [Route("v1/Dis_prnettra_list")]
        [HttpGet]
        public ResponseModel Dis_prnettra_list([FromUri] Dis_pre_prnettraModel Dis_pre_prnettraModel)
        {
            try
            {
                DiscountRepository DiscountRepository = new DiscountRepository();

                List<Dis_pre_prnettraModel> Dis_prnettra_list = DiscountRepository.Dis_pre_prnettra_list(Dis_pre_prnettraModel);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Dis_prnettra_list;
                _ResponseModel.length = Dis_prnettra_list.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }

        [Route("v1/Dis_prnettra_action")]
        [HttpPost]
        public ResponseModel Dis_prnettra_action([FromBody] Dis_pre_prnettraModel Dis_pre_prnettraModel)
        {
            try
            {

               ResponseModel _ResponseGunitkModel = new ResponseModel();
                ResponseModel _ResponseCheckModel = new ResponseModel();
                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseCheckModel = Dis_prnettra_check(Dis_pre_prnettraModel.ecode, Dis_pre_prnettraModel.gcode);
                _ResponseGunitkModel = Dis_prnettra_gunit(Dis_pre_prnettraModel.gcode, Dis_pre_prnettraModel.gunit);

                //_ResponseGunitkModel.data[0].check_status
                if (_ResponseGunitkModel.length <= 0)
                {
                    DiscountRepository DiscountRepository = new DiscountRepository();

                    DiscountRepository.Dis_prnettra_action(Dis_pre_prnettraModel);

                    _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                    _ResponseModel.data = _ResponseGunitkModel.length;
                    _ResponseModel.status = "Not_Found_Gunit";

                }
                else if (_ResponseCheckModel.length <= 0 && Dis_pre_prnettraModel.mode == "CREATE")
                {
                    DiscountRepository DiscountRepository = new DiscountRepository();

                    DiscountRepository.Dis_prnettra_action(Dis_pre_prnettraModel);

                    _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                    _ResponseModel.data = Dis_pre_prnettraModel.mode;
                    _ResponseModel.status = "Success";

                }
                else if (_ResponseCheckModel.length > 0 && Dis_pre_prnettraModel.mode == "CREATE")
                {
                    _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                    _ResponseModel.length = _ResponseCheckModel.length;
                    _ResponseModel.status = "Duplicate";

                }
                else if (_ResponseCheckModel.length > 0 && Dis_pre_prnettraModel.mode != "CREATE")
                {
                    DiscountRepository DiscountRepository = new DiscountRepository();

                    DiscountRepository.Dis_prnettra_action(Dis_pre_prnettraModel);

                    _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                    _ResponseModel.data = Dis_pre_prnettraModel.mode;
                    _ResponseModel.status = "Success";

                }
                else
                {
                    _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                    _ResponseModel.length = _ResponseCheckModel.length;
                    _ResponseModel.status = "Error";
                }


                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }

        [Route("v1/Dis_prnettra_check")]
        [HttpPost]
        public ResponseModel Dis_prnettra_check([FromBody] string ecode, string gcode)
        {
            try
            {
                DiscountRepository DiscountRepository = new DiscountRepository();

                List<Dis_prnetfile_check_Model> Dis_prnettra_check = DiscountRepository.Dis_prnettra_check(ecode, gcode);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Dis_prnettra_check;
                _ResponseModel.length = Dis_prnettra_check.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }

        [Route("v1/Dis_prnettra_gunit")]
        [HttpGet]
        public ResponseModel Dis_prnettra_gunit([FromUri] string gcode, string gunit)
        {
            try
            {
                DiscountRepository DiscountRepository = new DiscountRepository();

                List<Dis_prnetfile_check_Model> Dis_prnettra_gunit = DiscountRepository.Dis_prnettra_gunit(gcode, gunit);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Dis_prnettra_gunit;
                _ResponseModel.length = Dis_prnettra_gunit.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }

        [Route("v1/Dis_prnettra_import_upload")]
        [HttpGet]
        public ResponseModel Dis_prnettra_import_upload([FromUri] string ref_id)
        {
            try
            {
                DiscountRepository DiscountRepository = new DiscountRepository();

                List<Dis_pre_prnettraModel> Dis_prnettra_import_upload = DiscountRepository.Dis_prnettra_import_upload(ref_id);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Dis_prnettra_import_upload;
                _ResponseModel.length = Dis_prnettra_import_upload.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }

        [Route("v1/Dis_prnettra_import_verify")]
        [HttpPost]
        public ResponseModel Dis_prnettra_import_verify(List<Dis_pre_prnettraModel> Dis_pre_prnettraModel)
        {

            try
            {
                DiscountRepository DiscountRepository = new DiscountRepository();

                List<Dis_pre_prnettraModel> Dis_pre_prnettraList = new List<Dis_pre_prnettraModel>();

                foreach (var Dis_pre_prnettraItem in Dis_pre_prnettraModel)
                {
                    Dis_pre_prnettraModel Dis_pre_prnettraData = new Dis_pre_prnettraModel();
                    Dis_pre_prnettraData.gcode = Dis_pre_prnettraItem.gcode;
                    Dis_pre_prnettraData.gname = Dis_pre_prnettraItem.gname;
                    Dis_pre_prnettraData.Qty_A = Dis_pre_prnettraItem.Qty_A;
                    Dis_pre_prnettraData.Qty_B = Dis_pre_prnettraItem.Qty_B;
                    Dis_pre_prnettraData.NetPrice = Dis_pre_prnettraItem.NetPrice;
                    Dis_pre_prnettraData.gunit = Dis_pre_prnettraItem.gunit;
                    Dis_pre_prnettraData.session_id = Dis_pre_prnettraItem.session_id;
                    Dis_pre_prnettraData.userid = Dis_pre_prnettraItem.userid;
                    Dis_pre_prnettraData.ecode = Dis_pre_prnettraItem.ecode;
                    Dis_pre_prnettraData.ref_id = Dis_pre_prnettraItem.ref_id;

                    Dis_pre_prnettraList.Add(Dis_pre_prnettraData);
                }

                List<Dis_pre_prnettraModel> prnettra_import_verify_list = DiscountRepository.Dis_prnettra_import_verify(Dis_pre_prnettraList);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = prnettra_import_verify_list;
                _ResponseModel.length = prnettra_import_verify_list.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }



        [Route("v1/Dis_ediscount_list")]
        [HttpGet]
        public ResponseModel Dis_ediscount_list([FromUri] Dis_ediscountModel Dis_ediscountModel)
        {
            try
            {
                DiscountRepository DiscountRepository = new DiscountRepository();

                List<Dis_ediscountModel> Dis_ediscount_list = DiscountRepository.Dis_ediscount_list(Dis_ediscountModel);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Dis_ediscount_list;
                _ResponseModel.length = Dis_ediscount_list.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }

        [Route("v1/Dis_ediscount_action")]
        [HttpPost]
        public ResponseModel Dis_ediscount_action([FromBody] Dis_ediscountModel Dis_ediscountModel)
        {
            try
            {

                ResponseModel _ResponseCheckModel = new ResponseModel();
                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseCheckModel = Dis_ediscount_check(Dis_ediscountModel.code, Dis_ediscountModel.cargroup, Dis_ediscountModel.ecode);


                if (_ResponseCheckModel.length <= 0 && Dis_ediscountModel.mode == "CREATE")
                {
                    DiscountRepository DiscountRepository = new DiscountRepository();

                    DiscountRepository.Dis_ediscount_action(Dis_ediscountModel);

                    _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                    _ResponseModel.data = Dis_ediscountModel.mode;
                    _ResponseModel.status = "Success";

                }
                else if (_ResponseCheckModel.length > 0 && Dis_ediscountModel.mode == "CREATE")
                {
                    _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                    _ResponseModel.length = _ResponseCheckModel.length;
                    _ResponseModel.status = "Duplicate";

                }
                else if (_ResponseCheckModel.length > 0 && Dis_ediscountModel.mode != "CREATE")
                {
                    DiscountRepository DiscountRepository = new DiscountRepository();

                    DiscountRepository.Dis_ediscount_action(Dis_ediscountModel);

                    _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                    _ResponseModel.data = Dis_ediscountModel.mode;
                    _ResponseModel.status = "Success";

                }
                else
                {
                    _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                    _ResponseModel.length = _ResponseCheckModel.length;
                    _ResponseModel.status = "Error";
                }


                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }

        [Route("v1/Dis_ediscount_check")]
        [HttpGet]
        public ResponseModel Dis_ediscount_check([FromUri] string code, string cargroup, string ecode)
        {
            try
            {
                DiscountRepository DiscountRepository = new DiscountRepository();

                List<Dis_ediscountModel> Dis_ediscount_check = DiscountRepository.Dis_ediscount_check(code, cargroup, ecode);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Dis_ediscount_check;
                _ResponseModel.length = Dis_ediscount_check.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }

        [Route("v1/Dis_ediscount_import_verify")]
        [HttpPost]
        public ResponseModel Dis_ediscount_import_verify(List<Dis_ediscountModel> Dis_ediscountModel)
        {

            try
            {
                DiscountRepository DiscountRepository = new DiscountRepository();

                List<Dis_ediscountModel> Dis_pre_ediscountList = new List<Dis_ediscountModel>();

                foreach (var Dis_pre_ediscountItem in Dis_ediscountModel)
                {
                    Dis_ediscountModel Dis_pre_ediscountData = new Dis_ediscountModel();

                    Dis_pre_ediscountData.code = Dis_pre_ediscountItem.code;
                    Dis_pre_ediscountData.cargroup = Dis_pre_ediscountItem.cargroup;
                    Dis_pre_ediscountData.chrcode = Dis_pre_ediscountItem.chrcode;
                    Dis_pre_ediscountData.adis1 = Dis_pre_ediscountItem.adis1;
                    Dis_pre_ediscountData.adis2 = Dis_pre_ediscountItem.adis2;
                    Dis_pre_ediscountData.adis3 = Dis_pre_ediscountItem.adis3;      
                    Dis_pre_ediscountData.bdis1 = Dis_pre_ediscountItem.bdis1;
                    Dis_pre_ediscountData.bdis2 = Dis_pre_ediscountItem.bdis2;
                    Dis_pre_ediscountData.bdis3 = Dis_pre_ediscountItem.bdis3;
                    Dis_pre_ediscountData.cdis1 = Dis_pre_ediscountItem.cdis1;
                    Dis_pre_ediscountData.cdis2 = Dis_pre_ediscountItem.cdis2;
                    Dis_pre_ediscountData.cdis3 = Dis_pre_ediscountItem.cdis3;
                    Dis_pre_ediscountData.ddis1 = Dis_pre_ediscountItem.ddis1;
                    Dis_pre_ediscountData.ddis2 = Dis_pre_ediscountItem.ddis2;
                    Dis_pre_ediscountData.ddis3 = Dis_pre_ediscountItem.ddis3;
                    Dis_pre_ediscountData.edis1 = Dis_pre_ediscountItem.edis1;
                    Dis_pre_ediscountData.edis2 = Dis_pre_ediscountItem.edis2;
                    Dis_pre_ediscountData.edis3 = Dis_pre_ediscountItem.edis3;
                    Dis_pre_ediscountData.dvat = Dis_pre_ediscountItem.dvat;
                    Dis_pre_ediscountData.ecode = Dis_pre_ediscountItem.ecode;
                    Dis_pre_ediscountData.created_by = Dis_pre_ediscountItem.created_by;
                    Dis_pre_ediscountData.mode = Dis_pre_ediscountItem.mode;
                    Dis_pre_ediscountData.ref_id = Dis_pre_ediscountItem.ref_id;

                    Dis_pre_ediscountList.Add(Dis_pre_ediscountData);
                }

                List<Dis_ediscountModel> ediscount_import_verify_list = DiscountRepository.Dis_ediscount_import_verify(Dis_pre_ediscountList);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = ediscount_import_verify_list;
                _ResponseModel.length = ediscount_import_verify_list.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }

        [Route("v1/Dis_ediscount_import_upload")]
        [HttpGet]
        public ResponseModel Dis_ediscount_import_upload([FromUri] string ref_id)
        {
            try
            {
                DiscountRepository DiscountRepository = new DiscountRepository();

                List<Dis_ediscountModel> Dis_ediscount_import_upload = DiscountRepository.Dis_ediscount_import_upload(ref_id);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Dis_ediscount_import_upload;
                _ResponseModel.length = Dis_ediscount_import_upload.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }



        [Route("v1/Dis_gdishead_list")]
        [HttpGet]
        public ResponseModel Dis_gdishead_list([FromUri] string mode)
        {
            try
            {
                DiscountRepository DiscountRepository = new DiscountRepository();

                List<Dis_gdisheadModel> Dis_gdishead_list = DiscountRepository.Dis_gdishead_list(mode);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Dis_gdishead_list;
                _ResponseModel.length = Dis_gdishead_list.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }

        [Route("v1/Dis_gdishead_check")]
        [HttpGet]
        public ResponseModel Dis_gdishead_check([FromUri] string code)
        {
            try
            {
                DiscountRepository DiscountRepository = new DiscountRepository();

                List<Dis_gdisheadModel> Dis_gdishead_check = DiscountRepository.Dis_gdishead_check(code);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Dis_gdishead_check;
                _ResponseModel.length = Dis_gdishead_check.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }

        [Route("v1/Dis_gdishead_action")]
        [HttpPost]
        public ResponseModel Dis_gdishead_action([FromBody] Dis_gdisheadModel Dis_gdisheadModel)
        {
            try
            {

                ResponseModel _ResponseCheckModel = new ResponseModel();
                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseCheckModel = Dis_gdishead_check(Dis_gdisheadModel.code);

                if (_ResponseCheckModel.length <= 0 && Dis_gdisheadModel.mode == "CREATE")
                {
                    DiscountRepository DiscountRepository = new DiscountRepository();

                    DiscountRepository.Dis_gdishead_action(Dis_gdisheadModel);

                    _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                    _ResponseModel.data = Dis_gdisheadModel.mode;
                    //_ResponseModel.length = Dis_prnetfile_action.Count();
                    _ResponseModel.status = "Success";

                }
                else if (_ResponseCheckModel.length > 0 && Dis_gdisheadModel.mode == "CREATE")
                {

                    _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                    _ResponseModel.length = _ResponseCheckModel.length;
                    _ResponseModel.status = "Duplicate";

                }
                else if (_ResponseCheckModel.length > 0 && Dis_gdisheadModel.mode != "CREATE")
                {

                    DiscountRepository DiscountRepository = new DiscountRepository();

                    DiscountRepository.Dis_gdishead_action(Dis_gdisheadModel);

                    _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                    _ResponseModel.data = Dis_gdisheadModel.mode;
                    //_ResponseModel.length = Dis_prnetfile_action.Count();
                    _ResponseModel.status = "Success";

                }
                else
                {
                    _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                    _ResponseModel.length = _ResponseCheckModel.length;
                    _ResponseModel.status = "Error";
                }


                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }

    }

}
