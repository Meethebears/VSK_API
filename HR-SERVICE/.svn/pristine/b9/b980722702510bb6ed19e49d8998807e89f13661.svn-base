using REPO.Models;
using REPO.Controllers;
using System.Web.Http;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Globalization;

namespace API.Controllers
{
    public class HrController : ApiController
    {
        #region Hr_Job_Get
        [Route("api/Hr_Job_Get")]
        [HttpGet]
        public ResponseModel Hr_Job_Get([FromUri] JobModel JobModel)
        {

            try
            {
                CultureInfo cultureinfo = new CultureInfo("en-US");

                HrRepository HrRepository = new HrRepository();

                List<JobModel> Hr_Job_Get = HrRepository.Hr_Job_Get(JobModel);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Hr_Job_Get;
                _ResponseModel.length = Hr_Job_Get.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;

            }
            catch (Exception ex)
            {

                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }
        #endregion

        #region Hr_Detail_Get
        [Route("api/Hr_Detail_Get")]
        [HttpGet]
        public ResponseModel Hr_Detail_Get([FromUri] DetailModel DetailModel)
        {

            try
            {
                CultureInfo cultureinfo = new CultureInfo("en-US");

                HrRepository HrRepository = new HrRepository();

                List<DetailModel> Hr_Detail_Get = HrRepository.Hr_Detail_Get(DetailModel);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Hr_Detail_Get;
                _ResponseModel.length = Hr_Detail_Get.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;

            }
            catch (Exception ex)
            {

                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }
        #endregion

        #region Hr_Quarter_Get
        [Route("api/Hr_Quarter_Get")]
        [HttpGet]
        public ResponseModel Hr_Quarter_Get([FromUri] QuarterModel QuarterModel)
        {

            try
            {
                CultureInfo cultureinfo = new CultureInfo("en-US");

                HrRepository HrRepository = new HrRepository();

                List<QuarterModel> Hr_Quarter_Get = HrRepository.Hr_Quarter_Get(QuarterModel);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Hr_Quarter_Get;
                _ResponseModel.length = Hr_Quarter_Get.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;

            }
            catch (Exception ex)
            {

                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }
        #endregion

        #region Hr_Quarter_Create
        [Route("api/Hr_Quarter_Create")]
        [HttpPost]
        public ResponseModel Hr_Quarter_Create([FromBody] QuarterModel QuarterModel)
        {

            try
            {
                CultureInfo cultureinfo = new CultureInfo("en-US");

                HrRepository HrRepository = new HrRepository();

                List<QuarterModel> Hr_Quarter_Create = HrRepository.Hr_Quarter_Create(QuarterModel);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Hr_Quarter_Create;
                _ResponseModel.length = Hr_Quarter_Create.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;

            }
            catch (Exception ex)
            {

                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }
        #endregion

        #region Hr_Quarter_Update
        [Route("api/Hr_Quarter_Update")]
        [HttpPost]
        public ResponseModel Hr_Quarter_Update([FromBody] QuarterModel QuarterModel)
        {

            try
            {
                CultureInfo cultureinfo = new CultureInfo("en-US");

                HrRepository HrRepository = new HrRepository();

                List<QuarterModel> Hr_Quarter_Update = HrRepository.Hr_Quarter_Update(QuarterModel);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Hr_Quarter_Update;
                _ResponseModel.length = Hr_Quarter_Update.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;

            }
            catch (Exception ex)
            {

                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }
        #endregion

        #region Hr_Create_Data
        [Route("api/Hr_Create_Data")]
        [HttpPost]
        public ResponseModel Hr_Create_Data([FromBody] CreatePMSModel CreatePMSModel)
        {

            try
            {
                CultureInfo cultureinfo = new CultureInfo("en-US");

                HrRepository HrRepository = new HrRepository();

                List<CreatePMSModel> Hr_Create_Data = HrRepository.Hr_Create_Data(CreatePMSModel);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Hr_Create_Data;
                _ResponseModel.length = Hr_Create_Data.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;

            }
            catch (Exception ex)
            {

                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }
        #endregion

        #region Hr_Create_Score
        [Route("api/Hr_Create_Score")]
        [HttpPost]
        public ResponseModel Hr_Create_Score(List<CreatePMSModel> CreatePMSModel)
        {
            try
            {
                List<CreatePMSModel> CreatePMSModelList = new List<CreatePMSModel>();
                HrRepository HrRepository = new HrRepository();
                foreach (var CreatePMSItem in CreatePMSModel)
                {

                    CreatePMSModel CreatePMSModel_data = new CreatePMSModel();
                    CreatePMSModel_data.sc_data_id = CreatePMSItem.sc_data_id;
                    CreatePMSModel_data.sc_topic = CreatePMSItem.sc_topic;
                    CreatePMSModel_data.sc_score = CreatePMSItem.sc_score;
                    CreatePMSModel_data.sc_comment = CreatePMSItem.sc_comment;
                    CreatePMSModel_data.sc_c_point = CreatePMSItem.sc_c_point;
                    CreatePMSModel_data.sc_c_improve = CreatePMSItem.sc_c_improve;
                    CreatePMSModel_data.created_by = CreatePMSItem.created_by;
                    CreatePMSModelList.Add(CreatePMSModel_data);
                    HrRepository.Hr_Create_Score(CreatePMSModel_data);
                }

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Success";

                return _ResponseModel;

            }
            catch (Exception ex)
            {

                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }
        }
        #endregion

        #region Hr_Employee_Create
        [Route("api/Hr_Employee_Create")]
        [HttpPost]
        public ResponseModel Hr_Employee_Create([FromBody] EmployeeModel EmployeeModel)
        {

            try
            {
                CultureInfo cultureinfo = new CultureInfo("en-US");

                HrRepository HrRepository = new HrRepository();

                List<EmployeeModel> Hr_Employee_Create = HrRepository.Hr_Employee_Create(EmployeeModel);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Hr_Employee_Create;
                _ResponseModel.length = Hr_Employee_Create.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;

            }
            catch (Exception ex)
            {

                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }
        #endregion

        #region Hr_Employee_Update
        [Route("api/Hr_Employee_Update")]
        [HttpPost]
        public ResponseModel Hr_Employee_Update([FromBody] EmployeeModel EmployeeModel)
        {

            try
            {
                CultureInfo cultureinfo = new CultureInfo("en-US");

                HrRepository HrRepository = new HrRepository();

                List<EmployeeModel> Hr_Employee_Update = HrRepository.Hr_Employee_Update(EmployeeModel);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Hr_Employee_Update;
                _ResponseModel.length = Hr_Employee_Update.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;

            }
            catch (Exception ex)
            {

                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }
        #endregion

        #region Hr_Employee_Get
        [Route("api/Hr_Employee_Get")]
        [HttpGet]
        public ResponseModel Hr_Employee_Get([FromUri] EmployeeModel EmployeeModel)
        {

            try
            {
                CultureInfo cultureinfo = new CultureInfo("en-US");

                HrRepository HrRepository = new HrRepository();

                List<EmployeeModel> Hr_Employee_Get = HrRepository.Hr_Employee_Get(EmployeeModel);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Hr_Employee_Get;
                _ResponseModel.length = Hr_Employee_Get.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;

            }
            catch (Exception ex)
            {

                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }
        #endregion

        #region Hr_Employee_Delete
        [Route("api/Hr_Employee_Delete")]
        [HttpPost]
        public ResponseModel Hr_Employee_Delete([FromBody] EmployeeModel EmployeeModel)
        {

            try
            {
                CultureInfo cultureinfo = new CultureInfo("en-US");

                HrRepository HrRepository = new HrRepository();

                List<EmployeeModel> Hr_Employee_Delete = HrRepository.Hr_Employee_Delete(EmployeeModel);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Hr_Employee_Delete;
                _ResponseModel.length = Hr_Employee_Delete.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;

            }
            catch (Exception ex)
            {

                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }
        #endregion

        #region Hr_Time_Get
        [Route("api/Hr_Time_Get")]
        [HttpGet]
        public ResponseModel Hr_Time_Get([FromUri] TimeModel TimeModel)
        {

            try
            {
                CultureInfo cultureinfo = new CultureInfo("en-US");

                HrRepository HrRepository = new HrRepository();

                List<TimeModel> Hr_Time_Get = HrRepository.Hr_Time_Get(TimeModel);

                ResponseModel _ResponseModel = new ResponseModel();

                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.data = Hr_Time_Get;
                _ResponseModel.length = Hr_Time_Get.Count();
                _ResponseModel.status = "Success";

                return _ResponseModel;

            }
            catch (Exception ex)
            {

                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }
        #endregion

        #region Hr_Time_Create
        [Route("api/Hr_Time_Create")]
        [HttpPost]
        public ResponseModel Hr_Time_Create(List<TimeModel> TimeModel)
        {
            try
            {
                HrRepository HrRepository = new HrRepository();

                //HrRepository.TRP_TMS_Sync_Delete();

                List<TimeModel> TIME_JOBModelList = new List<TimeModel>();

                foreach (var TMS_JOBItem in TimeModel)
                {
                    TimeModel TIME_JOBModel_data = new TimeModel();

                    TIME_JOBModel_data.time_employee_code = TMS_JOBItem.time_employee_code;
                    TIME_JOBModel_data.time_employee_name = TMS_JOBItem.time_employee_name;
                    TIME_JOBModel_data.time_employee_pos = TMS_JOBItem.time_employee_pos;
                    TIME_JOBModel_data.time_late_count = TMS_JOBItem.time_late_count;
                    TIME_JOBModel_data.time_late_time = TMS_JOBItem.time_late_time;
                    TIME_JOBModel_data.time_absent_count = TMS_JOBItem.time_absent_count;
                    TIME_JOBModel_data.time_absent_time = TMS_JOBItem.time_absent_time;
                    TIME_JOBModel_data.time_sick_leave = TMS_JOBItem.time_sick_leave;
                    TIME_JOBModel_data.time_personal_leave = TMS_JOBItem.time_personal_leave;
                    TIME_JOBModel_data.time_maternity_leave = TMS_JOBItem.time_maternity_leave;
                    TIME_JOBModel_data.time_ordination_leave = TMS_JOBItem.time_ordination_leave;
                    TIME_JOBModel_data.time_wage_leave = TMS_JOBItem.time_wage_leave;
                    TIME_JOBModel_data.time_funeral_wedding_leave = TMS_JOBItem.time_funeral_wedding_leave;
                    TIME_JOBModel_data.time_warning_leave = TMS_JOBItem.time_warning_leave;
                    TIME_JOBModel_data.time_probate_leave = TMS_JOBItem.time_probate_leave;
                    TIME_JOBModel_data.time_data_quarter = TMS_JOBItem.time_data_quarter;
                    TIME_JOBModel_data.created_by = TMS_JOBItem.created_by;


                    TIME_JOBModelList.Add(TIME_JOBModel_data);

                }

                HrRepository.Hr_Time_Create(TIME_JOBModelList);

                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Success";

                return _ResponseModel;
            }
            catch (Exception ex)
            {
                ResponseModel _ResponseModel = new ResponseModel();
                _ResponseModel.result_datetime = DateTime.Now.ToString("yyyy-MM-dd hh:mm");
                _ResponseModel.status = "Error";
                _ResponseModel.error_message = ex.Message.ToString();
                _ResponseModel.error_stacktrace = ex.StackTrace.ToString();
                _ResponseModel.error_source = ex.Source.ToString();

                return _ResponseModel;
            }

        }

        #endregion
    }
}
